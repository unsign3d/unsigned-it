<!doctype html><html lang=en-us><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge,chrome=1"><title>DIY React state manager | Random thoughts and ideas</title><meta name=viewport content="width=device-width,minimum-scale=1"><meta name=description content="DIY React state manager This is a tutorial aim to demystify what libraries like react-redux does under the hood and learn about the new context apis
https://www.pexels.com/photo/woman-holding-white-string-lights-1366178/
Why even bother I think there are a couple of reasons why you should be interested in how state management works.
If you know how it works under the hood, a lot of problems that you might have will be more simple to debug, especially if you’re moving away from a consolidated library to a new library which is more edgy you could face some problems Global state is great but sometimes you don’t want to pollute it for ephemeral things, for example if you have a couple of components that needs to be rendered just in some occasions (loaders, small user stories) you may want to put it put of the global state use the internal state, this has pros (independency) and cons (multiple responsibilities of the component, not clear separation between data and view) Find new ways to avoid Prop Drilling when necessary, after playing around I found new ways to manage my dependencies What does a state manager even do then?"><meta name=generator content="Hugo 0.109.0"><meta name=robots content="noindex, nofollow"><link rel=stylesheet href=/ananke/css/main.min.css><meta property="og:title" content="DIY React state manager"><meta property="og:description" content="DIY React state manager This is a tutorial aim to demystify what libraries like react-redux does under the hood and learn about the new context apis
https://www.pexels.com/photo/woman-holding-white-string-lights-1366178/
Why even bother I think there are a couple of reasons why you should be interested in how state management works.
If you know how it works under the hood, a lot of problems that you might have will be more simple to debug, especially if you’re moving away from a consolidated library to a new library which is more edgy you could face some problems Global state is great but sometimes you don’t want to pollute it for ephemeral things, for example if you have a couple of components that needs to be rendered just in some occasions (loaders, small user stories) you may want to put it put of the global state use the internal state, this has pros (independency) and cons (multiple responsibilities of the component, not clear separation between data and view) Find new ways to avoid Prop Drilling when necessary, after playing around I found new ways to manage my dependencies What does a state manager even do then?"><meta property="og:type" content="article"><meta property="og:url" content="https://lucabruzzone.me/posts/2018-09-07-diy-react-state-manager/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2018-09-07T12:44:00+00:00"><meta property="article:modified_time" content="2018-09-07T12:44:00+00:00"><meta itemprop=name content="DIY React state manager"><meta itemprop=description content="DIY React state manager This is a tutorial aim to demystify what libraries like react-redux does under the hood and learn about the new context apis
https://www.pexels.com/photo/woman-holding-white-string-lights-1366178/
Why even bother I think there are a couple of reasons why you should be interested in how state management works.
If you know how it works under the hood, a lot of problems that you might have will be more simple to debug, especially if you’re moving away from a consolidated library to a new library which is more edgy you could face some problems Global state is great but sometimes you don’t want to pollute it for ephemeral things, for example if you have a couple of components that needs to be rendered just in some occasions (loaders, small user stories) you may want to put it put of the global state use the internal state, this has pros (independency) and cons (multiple responsibilities of the component, not clear separation between data and view) Find new ways to avoid Prop Drilling when necessary, after playing around I found new ways to manage my dependencies What does a state manager even do then?"><meta itemprop=datePublished content="2018-09-07T12:44:00+00:00"><meta itemprop=dateModified content="2018-09-07T12:44:00+00:00"><meta itemprop=wordCount content="681"><meta itemprop=keywords content><meta name=twitter:card content="summary"><meta name=twitter:title content="DIY React state manager"><meta name=twitter:description content="DIY React state manager This is a tutorial aim to demystify what libraries like react-redux does under the hood and learn about the new context apis
https://www.pexels.com/photo/woman-holding-white-string-lights-1366178/
Why even bother I think there are a couple of reasons why you should be interested in how state management works.
If you know how it works under the hood, a lot of problems that you might have will be more simple to debug, especially if you’re moving away from a consolidated library to a new library which is more edgy you could face some problems Global state is great but sometimes you don’t want to pollute it for ephemeral things, for example if you have a couple of components that needs to be rendered just in some occasions (loaders, small user stories) you may want to put it put of the global state use the internal state, this has pros (independency) and cons (multiple responsibilities of the component, not clear separation between data and view) Find new ways to avoid Prop Drilling when necessary, after playing around I found new ways to manage my dependencies What does a state manager even do then?"></head><body class="ma0 avenir bg-near-white"><header class="cover bg-top" style=background-image:url(https://lucabruzzone.me/images/pexels-designecologist-1366178.webp)><div class=bg-black-60><nav class="pv3 ph3 ph4-ns" role=navigation><div class="flex-l justify-between items-center center"><a href=/ class="f3 fw2 hover-white no-underline white-90 dib">Random thoughts and ideas</a><div class="flex-l items-center"><div class=ananke-socials><a href=/about-gdpr-tc target=_blank rel=noopener class="About me / GDPR / T&C ananke-social-link link-transition stackoverflow link dib z-999 pt3 pt0-l mr1" title="About me / GDPR / T&C link" aria-label="follow on About me / GDPR / T&C——Opens in a new window">About me / GDPR / T&C
<span class=new-window><svg height="8" style="enable-background:new 0 0 1000 1000" viewBox="0 0 1e3 1e3" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M598 128h298v298h-86V274L392 692l-60-60 418-418H598v-86zM810 810V512h86v298c0 46-40 86-86 86H214c-48 0-86-40-86-86V214c0-46 38-86 86-86h298v86H214v596h596z" style="fill-rule:evenodd;clip-rule:evenodd"/></svg></span></a><a href=https://mstdn.social/@unsigned target=_blank rel=noopener class="mastodon ananke-social-link link-transition stackoverflow link dib z-999 pt3 pt0-l mr1" title="Mastodon link" aria-label="follow on Mastodon——Opens in a new window"><span class=icon><svg style="enable-background:new 0 0 67 67" viewBox="0 0 67 67" xmlns="http://www.w3.org/2000/svg"><path d="M61.731833 16.783448C60.855064 10.336694 55.17491 5.2562169 48.441526 4.2717554 47.305526 4.1054038 43.001372 3.5 33.030833 3.5h-.07446c-9.973232.0-12.112924.6054038-13.248924.7717554C13.161526 5.2289477 7.1836569 9.7940169 5.7332999 16.317063c-.6976035 3.212462-.7720515 6.774-.6424569 10.041.1847407 4.685077.2205861 9.361923.6507292 14.027923.2973693 3.099385.8161231 6.174077 1.552377 9.201 1.3786615 5.590462 6.9594998 10.242769 12.4272688 12.140846 5.854077 1.979385 12.149615 2.307923 18.181846.949.663539-.152692 1.319846-.33 1.968693-.531769 1.464153-.460846 3.182-.976308 4.444846-1.881692.01731-.01269.03154-.02908.04154-.048.01-.01885.01562-.03977.01631-.06108v-4.521385c-308e-6-.01992-.0051-.03954-.014-.05738-.009-.01785-.02185-.03354-.03777-.04577-.01585-.01231-.03431-.02092-.05392-.02531-.01969-.0043-.04008-.0042-.05969 23e-5-3.864769.913077-7.825154 1.370769-11.798615 1.363539-6.838154.0-8.677308-3.209693-9.204-4.546-.423308-1.154846-.692154-2.359462-.799615-3.583308-.0011-.02054.0028-.04108.01115-.05992.0084-.01877.02123-.03538.03731-.04839.01615-.013.03515-.02208.05546-.02646.02031-.0045.04138-.004.06154.0012 3.800385.906846 7.696154 1.364538 11.605615 1.363538.940231.0 1.877693.0 2.818-.02454 3.931923-.109077 8.076154-.308154 11.944693-1.055385.09654-.01908.193-.03546.275769-.06 6.101923-1.159 11.908846-4.796846 12.498923-14.008846.02208-.362692.07723-3.798769.07723-4.175077.0028-1.279.416384-9.072846-.06069-13.861538zm-9.391461 22.98623H45.924141V24.225525c0-3.272462-1.378692-4.941385-4.182923-4.941385-3.082692.0-4.626769 1.974385-4.626769 5.874v8.508385H30.736757V25.15814c0-3.899615-1.546847-5.874-4.629539-5.874-2.787692.0-4.180154 1.668923-4.182923 4.941385V39.769678H15.513526V23.753755c0-3.272461.844692-5.87223 2.534-7.799384 1.742615-1.922539 4.028461-2.909693 6.865769-2.909693 3.283923.0 5.765538 1.248923 7.419923 3.744231l1.596539 2.650692 1.59923-2.650692c1.654385-2.495308 4.136-3.744231 7.414462-3.744231 2.834538.0 5.120308.987154 6.868461 2.909693 1.689385 1.925307 2.534 4.525077 2.534 7.799384z" style="fill-rule:evenodd;clip-rule:evenodd"/></svg></span><span class=new-window><svg height="8" style="enable-background:new 0 0 1000 1000" viewBox="0 0 1e3 1e3" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M598 128h298v298h-86V274L392 692l-60-60 418-418H598v-86zM810 810V512h86v298c0 46-40 86-86 86H214c-48 0-86-40-86-86V214c0-46 38-86 86-86h298v86H214v596h596z" style="fill-rule:evenodd;clip-rule:evenodd"/></svg></span></a><a href=https://github.com/unsign3d target=_blank rel=noopener class="github ananke-social-link link-transition stackoverflow link dib z-999 pt3 pt0-l mr1" title="GitHub link" aria-label="follow on GitHub——Opens in a new window"><span class=icon><svg style="enable-background:new 0 0 512 512" viewBox="0 0 512 512" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M256 32C132.3 32 32 134.8 32 261.7c0 101.5 64.2 187.5 153.2 217.9 11.2 2.1 15.3-5 15.3-11.1.0-5.5-.2-19.9-.3-39.1-62.3 13.9-75.5-30.8-75.5-30.8-10.2-26.5-24.9-33.6-24.9-33.6-20.3-14.3 1.5-14 1.5-14 22.5 1.6 34.3 23.7 34.3 23.7 20 35.1 52.4 25 65.2 19.1 2-14.8 7.8-25 14.2-30.7-49.7-5.8-102-25.5-102-113.5.0-25.1 8.7-45.6 23-61.6-2.3-5.8-10-29.2 2.2-60.8.0.0 18.8-6.2 61.6 23.5 17.9-5.1 37-7.6 56.1-7.7 19 .1 38.2 2.6 56.1 7.7 42.8-29.7 61.5-23.5 61.5-23.5 12.2 31.6 4.5 55 2.2 60.8 14.3 16.1 23 36.6 23 61.6.0 88.2-52.4 107.6-102.3 113.3 8 7.1 15.2 21.1 15.2 42.5.0 30.7-.3 55.5-.3 63 0 6.1 4 13.3 15.4 11C415.9 449.1 480 363.1 480 261.7 480 134.8 379.7 32 256 32z"/></svg></span><span class=new-window><svg height="8" style="enable-background:new 0 0 1000 1000" viewBox="0 0 1e3 1e3" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M598 128h298v298h-86V274L392 692l-60-60 418-418H598v-86zM810 810V512h86v298c0 46-40 86-86 86H214c-48 0-86-40-86-86V214c0-46 38-86 86-86h298v86H214v596h596z" style="fill-rule:evenodd;clip-rule:evenodd"/></svg></span></a></div></div></div></nav><div class="tc-l pv6 ph3 ph4-ns"><div class="f2 f1-l fw2 white-90 mb0 lh-title">DIY React state manager</div></div></div></header><main class=pb7 role=main><article class="flex-l flex-wrap justify-between mw8 center ph3"><header class="mt4 w-100"><aside class="instapaper_ignoref b helvetica tracked">POSTS</aside><div id=sharing class="mt3 ananke-socials"></div><h1 class="f1 athelas mt3 mb1">DIY React state manager</h1><p class=tracked>By <strong>Luca Bruzzone</strong></p><time class="f6 mv4 dib tracked" datetime=2018-09-07T12:44:00Z>September 7, 2018</time></header><div class="nested-copy-line-height lh-copy serif f4 nested-links mid-gray pr4-l w-two-thirds-l"><h2 id=diy-react-state-manager>DIY React state manager</h2><p>This is a tutorial aim to demystify what libraries like react-redux does under the hood and learn about the new context apis</p><p><a href=https://www.pexels.com/photo/woman-holding-white-string-lights-1366178/>https://www.pexels.com/photo/woman-holding-white-string-lights-1366178/</a></p><h4 id=why-even-bother>Why even bother</h4><p>I think there are a couple of reasons why you should be interested in how state management works.</p><ol><li>If you know how it works under the hood, a lot of problems that you might have will be more simple to debug, especially if you’re moving away from a consolidated library to a new library which is more edgy you could face some problems</li><li>Global state is great but sometimes you don’t want to pollute it for ephemeral things, for example if you have a couple of components that needs to be rendered just in some occasions (loaders, small user stories) you may want to put it put of the global state use the internal state, this has pros (independency) and cons (multiple responsibilities of the component, not clear separation between data and view)</li><li>Find new ways to avoid P<a href=https://blog.kentcdodds.com/prop-drilling-bb62e02cb691>rop Drilling</a> when necessary, after playing around I found new ways to manage my dependencies</li></ol><h4 id=what-does-a-state-manager-even-do-then>What does a state manager even do then?</h4><p>A state management is just a way to move the state from the component to outside of the component. In case you don’t know what a react state management is you can read <a href="https://jobs.zalando.com/tech/blog/state-management-react/?gh_src=4n3gxh1">this article from Zalando</a>.</p><h3 id=here-we-go>Here we go</h3><p>Few points before starting:</p><ul><li>The article will follow the code in <a href=https://github.com/unsign3d/react-context-global-state/>this repo</a></li><li>We are using the new <a href=https://reactjs.org/docs/context.html>Context Api</a>,</li></ul><p>This is the entry point of everything and we are doing mainly this:</p><ul><li>We are storing the state (within the component state)</li><li>We are creating a context provider with some rudimentary APIs</li><li>We are passing on the consumer</li></ul><h4 id=the-provider>The provider</h4><p>You may have encountered a context provider if you ever set up a react-redux project. The behaviour it’s quite straight forward, every children component will be able to ask for the state. If you’re just using the context api it will be just the context.</p><p>If you look at the code you will note that we need to give some features to the basic context provider:</p><ul><li>Binding of the context to a component state</li><li>Exposing an api to change the state</li><li>Basic debugging logs</li></ul><h4 id=the-consumer>The consumer</h4><p>The consumer is actually the most boring part of it, you can basically use the Context consumer as is, you just need to include your component and you will have a block with the context.</p><p>My dislike for this approach comes from 2 major points</p><ul><li>Separation between data logic (in this case context) and view logic</li><li>Future proofing the code, if you want to change to a new state manager you should be able to just change the glue code and not rewriting your components</li><li>[bonus] having a connected object actually gives you much more flexibility and you can combine in one place data from different sources without the component caring where they came from</li></ul><p>DISCLAIMER: My implementation is fairly opinionated by react-redux, you can use different patterns</p><p>This is the basic implementation of the connect function</p><p>And this is the basic usage of the connect function</p><p>This is the vanilla React Cat object</p><p>There are a few concepts from this 3 pieces of code</p><ul><li>You can use the “vanilla version” of the context exactly like I created the connect function, the connect function will just DRY out the usage</li><li>You can map context to props manually, this means that you can add external props and mix them to the context state (as in react-redux)</li><li>Cat.js is vanilla React, he doesn’t care about how the data got there, he knows what data is from the input and how to use it</li></ul><h3 id=closing-remarks>Closing remarks</h3><p>I hope to have demystified the magic behind what is a state manager and how to use the new Context Api.</p><p>I hope that you will also be able to more critical choose which tool is best for you between state manager, context api and just prop drilling</p><p>Many thanks to <a href=https://medium.com/@marcopoliefesto>https://medium.com/@marcopoliefesto</a> for proofreading and giving cool feedback on this article</p><ul class=pa0></ul><div class="mt6 instapaper_ignoref"></div></div><aside class="w-30-l mt6-l"></aside></article></main><footer class="bg-black bottom-0 w-100 pa3" role=contentinfo><div class="flex justify-between"><a class="f4 fw4 hover-white no-underline white-70 dn dib-ns pv2 ph3" href=https://lucabruzzone.me/>&copy; All content is under CC BY-SA license. Luca Bruzzone 2023</a><div><div class=ananke-socials><a href=/about-gdpr-tc target=_blank rel=noopener class="About me / GDPR / T&C ananke-social-link link-transition stackoverflow link dib z-999 pt3 pt0-l mr1" title="About me / GDPR / T&C link" aria-label="follow on About me / GDPR / T&C——Opens in a new window">About me / GDPR / T&C
<span class=new-window><svg height="8" style="enable-background:new 0 0 1000 1000" viewBox="0 0 1e3 1e3" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M598 128h298v298h-86V274L392 692l-60-60 418-418H598v-86zM810 810V512h86v298c0 46-40 86-86 86H214c-48 0-86-40-86-86V214c0-46 38-86 86-86h298v86H214v596h596z" style="fill-rule:evenodd;clip-rule:evenodd"/></svg></span></a><a href=https://mstdn.social/@unsigned target=_blank rel=noopener class="mastodon ananke-social-link link-transition stackoverflow link dib z-999 pt3 pt0-l mr1" title="Mastodon link" aria-label="follow on Mastodon——Opens in a new window"><span class=icon><svg style="enable-background:new 0 0 67 67" viewBox="0 0 67 67" xmlns="http://www.w3.org/2000/svg"><path d="M61.731833 16.783448C60.855064 10.336694 55.17491 5.2562169 48.441526 4.2717554 47.305526 4.1054038 43.001372 3.5 33.030833 3.5h-.07446c-9.973232.0-12.112924.6054038-13.248924.7717554C13.161526 5.2289477 7.1836569 9.7940169 5.7332999 16.317063c-.6976035 3.212462-.7720515 6.774-.6424569 10.041.1847407 4.685077.2205861 9.361923.6507292 14.027923.2973693 3.099385.8161231 6.174077 1.552377 9.201 1.3786615 5.590462 6.9594998 10.242769 12.4272688 12.140846 5.854077 1.979385 12.149615 2.307923 18.181846.949.663539-.152692 1.319846-.33 1.968693-.531769 1.464153-.460846 3.182-.976308 4.444846-1.881692.01731-.01269.03154-.02908.04154-.048.01-.01885.01562-.03977.01631-.06108v-4.521385c-308e-6-.01992-.0051-.03954-.014-.05738-.009-.01785-.02185-.03354-.03777-.04577-.01585-.01231-.03431-.02092-.05392-.02531-.01969-.0043-.04008-.0042-.05969 23e-5-3.864769.913077-7.825154 1.370769-11.798615 1.363539-6.838154.0-8.677308-3.209693-9.204-4.546-.423308-1.154846-.692154-2.359462-.799615-3.583308-.0011-.02054.0028-.04108.01115-.05992.0084-.01877.02123-.03538.03731-.04839.01615-.013.03515-.02208.05546-.02646.02031-.0045.04138-.004.06154.0012 3.800385.906846 7.696154 1.364538 11.605615 1.363538.940231.0 1.877693.0 2.818-.02454 3.931923-.109077 8.076154-.308154 11.944693-1.055385.09654-.01908.193-.03546.275769-.06 6.101923-1.159 11.908846-4.796846 12.498923-14.008846.02208-.362692.07723-3.798769.07723-4.175077.0028-1.279.416384-9.072846-.06069-13.861538zm-9.391461 22.98623H45.924141V24.225525c0-3.272462-1.378692-4.941385-4.182923-4.941385-3.082692.0-4.626769 1.974385-4.626769 5.874v8.508385H30.736757V25.15814c0-3.899615-1.546847-5.874-4.629539-5.874-2.787692.0-4.180154 1.668923-4.182923 4.941385V39.769678H15.513526V23.753755c0-3.272461.844692-5.87223 2.534-7.799384 1.742615-1.922539 4.028461-2.909693 6.865769-2.909693 3.283923.0 5.765538 1.248923 7.419923 3.744231l1.596539 2.650692 1.59923-2.650692c1.654385-2.495308 4.136-3.744231 7.414462-3.744231 2.834538.0 5.120308.987154 6.868461 2.909693 1.689385 1.925307 2.534 4.525077 2.534 7.799384z" style="fill-rule:evenodd;clip-rule:evenodd"/></svg></span><span class=new-window><svg height="8" style="enable-background:new 0 0 1000 1000" viewBox="0 0 1e3 1e3" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M598 128h298v298h-86V274L392 692l-60-60 418-418H598v-86zM810 810V512h86v298c0 46-40 86-86 86H214c-48 0-86-40-86-86V214c0-46 38-86 86-86h298v86H214v596h596z" style="fill-rule:evenodd;clip-rule:evenodd"/></svg></span></a><a href=https://github.com/unsign3d target=_blank rel=noopener class="github ananke-social-link link-transition stackoverflow link dib z-999 pt3 pt0-l mr1" title="GitHub link" aria-label="follow on GitHub——Opens in a new window"><span class=icon><svg style="enable-background:new 0 0 512 512" viewBox="0 0 512 512" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M256 32C132.3 32 32 134.8 32 261.7c0 101.5 64.2 187.5 153.2 217.9 11.2 2.1 15.3-5 15.3-11.1.0-5.5-.2-19.9-.3-39.1-62.3 13.9-75.5-30.8-75.5-30.8-10.2-26.5-24.9-33.6-24.9-33.6-20.3-14.3 1.5-14 1.5-14 22.5 1.6 34.3 23.7 34.3 23.7 20 35.1 52.4 25 65.2 19.1 2-14.8 7.8-25 14.2-30.7-49.7-5.8-102-25.5-102-113.5.0-25.1 8.7-45.6 23-61.6-2.3-5.8-10-29.2 2.2-60.8.0.0 18.8-6.2 61.6 23.5 17.9-5.1 37-7.6 56.1-7.7 19 .1 38.2 2.6 56.1 7.7 42.8-29.7 61.5-23.5 61.5-23.5 12.2 31.6 4.5 55 2.2 60.8 14.3 16.1 23 36.6 23 61.6.0 88.2-52.4 107.6-102.3 113.3 8 7.1 15.2 21.1 15.2 42.5.0 30.7-.3 55.5-.3 63 0 6.1 4 13.3 15.4 11C415.9 449.1 480 363.1 480 261.7 480 134.8 379.7 32 256 32z"/></svg></span><span class=new-window><svg height="8" style="enable-background:new 0 0 1000 1000" viewBox="0 0 1e3 1e3" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M598 128h298v298h-86V274L392 692l-60-60 418-418H598v-86zM810 810V512h86v298c0 46-40 86-86 86H214c-48 0-86-40-86-86V214c0-46 38-86 86-86h298v86H214v596h596z" style="fill-rule:evenodd;clip-rule:evenodd"/></svg></span></a></div></div></div></footer></body></html>